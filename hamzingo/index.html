<!DOCTYPE html>
<html>
<head>
  <title>Hamzingo Card</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f0f5f9;
      color: #333;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    h1 {
      font-size: 24px;
      color: #3498db;
    }

    table {
      border-collapse: collapse;
      margin: 20px 0;
    }

    table, th, td {
      border: 1px solid #3498db;
    }

    th, td {
      padding: 15px;
      cursor: pointer;
      text-align: center;
    }

    th.completed, td.completed {
      text-decoration: line-through;
      background-color: red;
    }

    button {
      background-color: #3498db;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background-color: #2980b9;
    }
  </style>
</head>
<body>
  <h1>Hamzingo Card</h1>
  <table id="bingo-card"></table>
  <button onclick="generateCard()">Generate New Card</button>

  <script>
    var topicsKey = "bingoTopics";
    var stateKeyPrefix = "cell_";

    // Function to generate the bingo card
    function generateCard() {
      var card = document.getElementById("bingo-card");
      card.innerHTML = '';

      var questions = generateRandomQuestions();
      localStorage.setItem(topicsKey, JSON.stringify(questions));

      clearCompletedState();

      for (var i = 0; i < 5; i++) {
        var row = card.insertRow();

        for (var j = 0; j < 5; j++) {
          var cell = row.insertCell();
          if (i === 2 && j === 2) {
            cell.textContent = "FREE SPACE";
            cell.style.fontWeight = "bold";
          } else {
            cell.textContent = questions[i * 5 + j];
            var cellState = localStorage.getItem(stateKeyPrefix + i + "_" + j);
            if (cellState === "completed") {
              cell.classList.add("completed");
            }
            cell.onclick = function() {
              this.classList.toggle("completed");
              var key = stateKeyPrefix + this.parentNode.rowIndex + "_" + this.cellIndex;
              localStorage.setItem(key, this.classList.contains("completed") ? "completed" : "");
            };
          }
        }
      }
    }

    // Function to generate random questions
    function generateRandomQuestions() {
      var allQuestions = [
        "Question 1", "Question 2", "Question 3", "Question 4", "Question 5",
        "Question 6", "Question 7", "Question 8", "Question 9", "Question 10",
        "Question 11", "Question 12", "Question 13", "Question 14", "Question 15",
        "Question 16", "Question 17", "Question 18", "Question 19", "Question 20",
        "Question 21", "Question 22", "Question 23", "Question 24", "Question 25"
      ];

      allQuestions.sort(() => Math.random() - 0.5);
      return allQuestions.slice(0, 25);
    }

    // Function to clear the completed state from all cells
    function clearCompletedState() {
      var cells = document.querySelectorAll("td");
      cells.forEach(function(cell) {
        cell.classList.remove("completed");
        localStorage.removeItem(stateKeyPrefix + cell.parentNode.rowIndex + "_" + cell.cellIndex);
      });
    }

    // Generate the bingo card on first load
    window.onload = function() {
      if (!localStorage.getItem(topicsKey)) {
        generateCard();
      } else {
        generateSavedCard();
      }
    };

    // Function to generate the bingo card from saved state
    function generateSavedCard() {
      var card = document.getElementById("bingo-card");
      card.innerHTML = '';

      var questions = JSON.parse(localStorage.getItem(topicsKey));

      for (var i = 0; i < 5; i++) {
        var row = card.insertRow();

        for (var j = 0; j < 5; j++) {
          var cell = row.insertCell();
          if (i === 2 && j === 2) {
            cell.textContent = "FREE SPACE";
            cell.style.fontWeight = "bold";
          } else {
            cell.textContent = questions[i * 5 + j];
            var cellState = localStorage.getItem(stateKeyPrefix + i + "_" + j);
            if (cellState === "completed") {
              cell.classList.add("completed");
            }
            cell.onclick = function() {
              this.classList.toggle("completed");
              var key = stateKeyPrefix + this.parentNode.rowIndex + "_" + this.cellIndex;
              localStorage.setItem(key, this.classList.contains("completed") ? "completed" : "");
            };
          }
        }
      }
    }
  </script>
</body>
</html>